\documentclass[traditabstract]{aa}

\usepackage{graphicx}
\usepackage{txfonts}
\usepackage{natbib}
\usepackage{xspace}
\usepackage{url}
\bibpunct{(}{)}{;}{a}{}{,}

\begin{document}

\title{PyCS time delay measurement on TDC1}
\author{ In alphabetical order:
V. Bonvin\inst{\ref{epfl}} \and
F. Courbin\inst{\ref{epfl}} \and
M. Tewes\inst{\ref{bonn}}
}

\institute{
Laboratoire d'astrophysique, Ecole Polytechnique F\'ed\'erale de Lausanne (EPFL), Observatoire de Sauverny, 1290 Versoix, Switzerland \label{epfl}
\and
Argelander-Institut f\"ur Astronomie, Auf dem H\"ugel 71, D-53121 Bonn, Germany \label{bonn}
}

\date{\today}
%\abstract{}

\maketitle


% -Authors and affiliations
% -Description of your method(s)
% -Description of internal testing and/or references to prior applications of the method
% -A description of the strategy you have used to identify catastrophic failures
%We realize there is not a lot of time between now and the deadline, but it is important that this paragraph of text be written blind as well. Please keep it short! This is only meant to be a brief summary for each team. We encourage you to write up your method separately if you wish so.

\section{PyCS method descriptions}

The PyCS team has made submissions using 3 time-delay measurement methods: {\tt d3cs}, {\tt spl}, and {\tt sdi}. The last two of them build upon initial estimations provided by the first one. We summarize the methods in the following. 

\subsection{{\tt d3cs}: D3 curve shifting}
This first method is based on human inspection of the light curves, in the spirit of citizen science projects. We have developed a dedicated browser-based visualization interface, using the D3.js JavaScript library\footnote{Data-Driven Documents, \url{http://www.d3js.org/}} by \citet{d3}. Our tool is now publicly available online\footnote{\url{http://www.astro.uni-bonn.de/~mtewes/d3cs/tdc1/} (See ``Read me first'' for help)} [Note: not sure if you/we want to leave this URL in the TDC paper, but feel free to explore and register estimates!]. The main motivations behind this time-costly yet simple approach was to obtain, for each curve pair, (1) a rough initial estimate for the time delay and associated uncertainty, and (2) a robust characterization of the confidence that this estimate is not a catastrophic error. Our interface allows users to interactively shift the light curves in time, magnitude, and flux, and to zoom in on interesting sections of the data. It enables to visually estimate both the time delay and an associated uncertainty. Importantly, the interface also asks to pick a confidence category for the proposed solution, among 4 choices:
\begin{enumerate}
\item ``doubtless'' if a catastrophic error can be excluded with a very high confidence,
\item ``plausible'' if the solution yields a good fit and no other solutions are seen,
\item ``multimodal'' if the proposed solution is only one among two or more possible solutions,
\item ``uninformative'' if the data does not reveal any delay.
\end{enumerate}
Only a small circle of scientists has participated to the visual inspection of TDC1, yet we obtained at least two estimates by different people for each pair of curves. Different users have taken significantly different typical amount of time to register their estimates, from $\approx 25$ s per pair for ``fast'' users (vb) to $> 60$ s per pair for ``slow'' users (mt). We have included submissions using raw estimates from such different users in our blind submission set. The database of d3cs estimates was then carefully reduced to a single estimate per pair, resolving any conflicts between estimates in a conservative way. A key result of this step is a sample of 1628 ``doubtless'' time-delay estimates, which, as we hope, is \emph{free} from any catastrophic outliers. Through this experiment, we have demonstrated that such an approach remains well tractable for about 5000 light curves.

\subsection{{\tt spl}: free-knot spline fit}
The {\tt spl} method is a simplified version of the ``free-knot spline technique'' described in \citet{pycs} and implemented in the PyCS software package. Using the {\tt d3cs} estimate as starting point, the method simultaneously fits one single spline representing the intrinsic QSO variability and a smoother ``extrinsic'' spline representing the differential microlensing variability to the light curves. During this iterative process, the curves are shifted in time so as to optimize the fit. We repeat this fit 20 times, starting form different initial conditions, to test and improve the robustness of the resulting delay against local minima of the $\chi^2$ hypersurface. Such a model fit is then used to generate 40 simulated noisy light curves with a range of true time delays around the best-fit solution. By rerunning the spline fit on these simulated curves, and comparing the resulting delays with the true input time delays, the delay measurement uncertainty is estimated.

The {\tt spl} method for TDC1 is simpler, faster, and significantly less conservative in the uncertainty estimation than the free-knot spline technique as applied to COSMOGRAIL data\footnote{\url{http://www.cosmograil.org}} in \citet{Tewes:2013iz} and \citet{RathnaKumar:2013eu}. In particular:
\begin{enumerate}
\item The temporal density of spline knots controling the flexibility of the intrinsic spline is computed from the signal-to-noise ratios measured on the two light curves, using an empirical calibration. These signal-to-noise ratios compare the typical amplitude of variability observed in a window of 50 to 75 days with the ``scatter'', that is the typical variability from one epoch to the next. For the extrinsic spline, the knot density is fixed to be the same for all TDC1 pairs.
\item We do not inject any fast microlensing signal into the simulated light curves on top of the smooth microlensing fit determined using the data. Only plain white noise is added to the generative model. 
\item We do not analyse the delay measurement errors on the simulated curves as a function of true delay. Instead, only the RMS error of these delay measurements is used as our total uncertainty estimate. 
\item Finally, we do not manually fine-tune any parameters or correct for problematic model fits. 
\end{enumerate}
These simplifications remove any form of ``safety margin'' from the free-knot spline technique that we had when applying to real datasets. We firmly expect the resulting TDC1 error estimates to be rather optimistic. The entire {\tt spl} analysis takes about 5 CPU-minutes for an average TDC1 pair.  

\subsection{\tt sdi}

Our third method, {\tt sdi} (for spline difference) is inspired by the ``regression difference technique'' of \citet{pycs}, replacing the Gaussian process regressions by spline fits, to speed up the analysis. The method fits a different spline to each of the two light curve, and then minimizes the variability of the difference between these two splines by shifting them in time with respect to each other. The advantage of this approach is that it does not require an explicit microlensing model. To estimate the uncertainty, this method uses the simulated light curves provided by the {\tt spl} technique. As for the {\tt spl} technique, the estimates from {\tt d3cs} are used as starting point to define the time delay intervals in which {\tt sdi} optimizes its cost function. We systematically discard a small number of {\tt spl} and {\tt sdi} measurements that do not lie within 1.5$\sigma$ of the corresponding {\tt d3cs} estimates.


\subsection{Catastrophic failures and testing}

To prevent catastrophic failures, we rely solely on the {\tt d3cs} ``doubtless'' sample. The {\tt spl} and {\tt sdi} methods do not affect this confidence classification. We explore the importance of a high-purity selection through submissions that mix the ``doubtless'' and ``plausible'' categories, which will certainly be contaminated by some catastrophic outliers, but feature more than twice the number of time delays.

We have not conducted any end-to-end testing of our methods, and in particular did not validate the simplifications implemented in the {\tt spl} error analysis prior to our blind submissions. 





\begin{acknowledgements}
VB and FC are supported by the Swiss National Science Foundation (SNSF). MT acknowledges support by the DFG grant Hi 1495/2-1.
\end{acknowledgements}



\bibliographystyle{aa}
\bibliography{pycs_description}

\end{document}



